{"componentChunkName":"component---src-templates-blog-post-js","path":"/early-returns-vs-single-return/","result":{"data":{"site":{"siteMetadata":{"title":"Tripping on Code","author":"Avinash"}},"markdownRemark":{"id":"ceb3d196-b22d-579f-bb6e-516edf0c76a6","excerpt":"When a developer is building an application of any complexity, they will have to write many conditional statements. Depending on the complexity of the problem…","html":"<p>When a developer is building an application of any complexity, they will have to write many conditional statements. Depending on the complexity of the problem, this can lead to heavy nesting of code. </p>\n<p>For Example:</p>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-csharp line-numbers\"><code class=\"language-csharp\"><span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">int</span><span class=\"token punctuation\">?</span></span> <span class=\"token function\">GetPersonAge</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> firstName<span class=\"token punctuation\">,</span> <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> lastName<span class=\"token punctuation\">)</span> \n<span class=\"token punctuation\">{</span>\n  <span class=\"token class-name\"><span class=\"token keyword\">int</span><span class=\"token punctuation\">?</span></span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">string</span><span class=\"token punctuation\">.</span><span class=\"token function\">IsNullOrWhitespace</span><span class=\"token punctuation\">(</span>firstName<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span><span class=\"token keyword\">string</span><span class=\"token punctuation\">.</span><span class=\"token function\">IsNullOrWhitespace</span><span class=\"token punctuation\">(</span>lastName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \n  <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> person <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>repository<span class=\"token punctuation\">.</span><span class=\"token function\">GetPerson</span><span class=\"token punctuation\">(</span>firstName<span class=\"token punctuation\">,</span> lastName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>person <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> \n    <span class=\"token punctuation\">{</span>\n      result <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">CalculateAge</span><span class=\"token punctuation\">(</span>person<span class=\"token punctuation\">.</span>DateOfBirth<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span> \n  <span class=\"token keyword\">else</span> \n  <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">ArgumentException</span><span class=\"token punctuation\">(</span><span class=\"token interpolation-string\"><span class=\"token string\">$\"nameof(firstName) &amp;&amp; nameof(lastName) cannot be null\"</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  \n  <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>The above function has a few flaws. </p>\n<ol>\n<li><strong>Readability</strong> - The code above is not very explicit in its intention. You need to read the entire method to realize that it returns null if no person is found.</li>\n<li><strong>The nesting</strong> - The actual logic of the method is captured in the call to invoke calculateAge. This is hidden in the deepest level of nesting.</li>\n</ol>\n<h2>Functional Programming</h2>\n<p>F# and other functional programming languages deal with this differently. In F#, an if statement is supposed to return a value. Take a look at the code below.</p>\n<div class=\"gatsby-highlight\" data-language=\"fsharp\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-fsharp line-numbers\"><code class=\"language-fsharp\"><span class=\"token keyword\">let</span> greatest a b c <span class=\"token operator\">=</span>\n\t<span class=\"token keyword\">if</span> a <span class=\"token operator\">>=</span> b <span class=\"token operator\">&amp;&amp;</span> a <span class=\"token operator\">>=</span> c \n  \t<span class=\"token keyword\">then</span> a\n  <span class=\"token keyword\">elif</span> b <span class=\"token operator\">>=</span> a <span class=\"token operator\">&amp;&amp;</span> b <span class=\"token operator\">>=</span> c \n    <span class=\"token keyword\">then</span> b\n  <span class=\"token keyword\">else</span> \n    c</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>The code above might be hard to read if you are unfamiliar with F#. But it makes a lot of sense. Let’s break it down.</p>\n<p><em>greatest</em> is a function that accepts three parameters, a, b and c, and returns the greatest of the three numbers. F# and many other functional programming languages do not have a return statement; it is assumed that all methods return something, and interestingly an if statement is no different. An if statement always returns a value. So in the code above, if a is greater than equal to b and c, it returns a.</p>\n<p>This pattern makes a lot of sense. Let’s try and apply this in C# and clean up the code.</p>\n<h2>The GetPersonAge function with early returns</h2>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-csharp line-numbers\"><code class=\"language-csharp\"><span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">int</span><span class=\"token punctuation\">?</span></span> <span class=\"token function\">GetPersonAge</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> firstName<span class=\"token punctuation\">,</span> <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> lastName<span class=\"token punctuation\">)</span> \n<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">string</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNullOrWhitespace</span><span class=\"token punctuation\">(</span>firstName<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token keyword\">string</span><span class=\"token punctuation\">.</span><span class=\"token function\">IsNullOrWhitespace</span><span class=\"token punctuation\">(</span>lastName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> \n  <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">ArgumentException</span><span class=\"token punctuation\">(</span><span class=\"token interpolation-string\"><span class=\"token string\">$\"nameof(firstName) &amp;&amp; nameof(lastName) cannot be null\"</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  \n  <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> person <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>repository<span class=\"token punctuation\">.</span><span class=\"token function\">GetPerson</span><span class=\"token punctuation\">(</span>firstName<span class=\"token punctuation\">,</span> lastName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>person <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> \n  <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  \n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">CalculateAge</span><span class=\"token punctuation\">(</span>person<span class=\"token punctuation\">.</span>DateOfBirth<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>The function above is a lot cleaner. The first few lines of code deal with the exceptional cases. It. explicity states the cases when it throws an exception </p>\n<h2>When to avoid Early Returns</h2>\n<p>As with almost every rule, you should only use early returns when it adds to the code’s maintainability and readability. </p>\n<p>There are cases when early returns make the code harder to read, as described in the following cases.</p>\n<ul>\n<li>Suppose you have a method that sets other properties or member variables in the class. In this case, adding early returns can introduce bugs and make the code harder to follow.</li>\n<li>When you have large if statements and many branching paths, here, early returns can be a detriment to readability.</li>\n<li>If you have logic after the if statement that needs to be executed, early returns are definitely not going to work. However, you might consider breaking out the conditional logic into its own method if it makes sense. </li>\n</ul>","frontmatter":{"title":"Early Returns","date":"January 12, 2021","description":"How to write more readable code using early returns. "}}},"pageContext":{"slug":"/early-returns-vs-single-return/","previous":{"fields":{"slug":"/keyed-collections/"},"frontmatter":{"title":"Keyed Collection in .Net"}},"next":{"fields":{"slug":"/group-by-vs-to-lookup/"},"frontmatter":{"title":"ToLookup vs. GroupBy"}}}},"staticQueryHashes":["426816048","63159454"]}